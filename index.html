<!DOCTYPE html>
<html lang="vi">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Mưa Tình Yêu</title>
<link href="https://fonts.googleapis.com/css2?family=Great+Vibes&display=swap" rel="stylesheet">
<style>
html, body {
  margin: 0;
  padding: 0;
  overflow: hidden;
  height: 100%;
  background-color: black;
  font-family: 'Great Vibes', cursive;
}
#loveRain, #cakeCanvas {
  position: fixed;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
}
.text {
  position: fixed;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%) scale(0);
  color: #ffffff;
  font-size: 8vw;
  text-align: center;
  opacity: 0;
  z-index: 2;
  transition: transform 1s ease, opacity 1s ease;
  text-shadow: 0 0 20px rgba(255, 182, 193, 0.6);
}
.show { opacity: 1; transform: translate(-50%, -50%) scale(1); }
.hide { opacity: 0; transform: translate(-50%, -50%) scale(0); }
</style>
</head>
<body>

<canvas id="loveRain"></canvas>
<canvas id="cakeCanvas"></canvas>

<div class="text" id="line1">Birthday 25+</div>
<div class="text" id="line2">13/11/2000</div>
<div class="text" id="line3">Wish Trâm Anh always happy</div>
<div class="text" id="line4">Wish all the best things come to<br>Trâm Anh &lt;3</div>

<script>
// ----------- Hiệu ứng mưa LOVE -----------
const rainCanvas = document.getElementById('loveRain');
const rctx = rainCanvas.getContext('2d');
rainCanvas.width = innerWidth;
rainCanvas.height = innerHeight;
const letters = "LOVE".split("");
const fontSize = 20;
const columns = Math.floor(rainCanvas.width / fontSize);
const drops = Array(columns).fill(1);

function drawRain() {
  rctx.fillStyle = "rgba(0,0,0,0.1)";
  rctx.fillRect(0, 0, rainCanvas.width, rainCanvas.height);
  rctx.fillStyle = "#ff8ed6";
  rctx.font = fontSize + "px monospace";
  for (let i = 0; i < drops.length; i++) {
    const text = letters[Math.floor(Math.random() * letters.length)];
    rctx.fillText(text, i * fontSize, drops[i] * fontSize);
    if (drops[i] * fontSize > rainCanvas.height && Math.random() > 0.975) drops[i] = 0;
    drops[i]++;
  }
}
setInterval(drawRain, 33);

// ----------- Hiển thị dòng chữ -----------
const lines = [
  document.getElementById("line1"),
  document.getElementById("line2"),
  document.getElementById("line3"),
  document.getElementById("line4")
];
let current = 0;
function showNextLine() {
  if (current > 0) {
    lines[current - 1].classList.remove("show");
    lines[current - 1].classList.add("hide");
  }
  if (current < lines.length) {
    setTimeout(() => {
      lines[current].classList.add("show");
      current++;
      setTimeout(showNextLine, 6000);
    }, 1000);
  } else {
    setTimeout(drawCake, 3000);
  }
}

// ----------- Bánh sinh nhật (viền trắng, cong hồng, nến đỏ, lửa vàng) -----------
const cakeCanvas = document.getElementById('cakeCanvas');
const ctx = cakeCanvas.getContext('2d');
cakeCanvas.width = innerWidth;
cakeCanvas.height = innerHeight;
let particles = [];

function random(min, max) { return Math.random() * (max - min) + min; }

function addRect(points, x1, y1, x2, y3, color) {
  for (let x = x1; x <= x2; x += 3) {
    points.push({x, y: y1, color});
    points.push({x, y: y3, color});
  }
  for (let y = y1; y <= y3; y += 3) {
    points.push({x: x1, y, color});
    points.push({x: x2, y, color});
  }
}

function addCurve(points, x1, x2, y, amp, freq, color) {
  for (let x = x1; x <= x2; x += 3) {
    const wave = amp * Math.sin((x - x1) / freq);
    points.push({x, y: y + wave, color});
  }
}

function createCakeOutline() {
  const pts = [];

  // --- Tầng 1 ---
  addRect(pts, -180, 100, 180, 150, "#ffffff");
  addCurve(pts, -180, 180, 125, 12, 20, "#ff8ed6");

  // --- Tầng 2 ---
  addRect(pts, -130, 40, 130, 90, "#ffffff");
  addCurve(pts, -130, 130, 65, 10, 18, "#ff8ed6");

  // --- Tầng 3 ---
  addRect(pts, -80, -10, 80, 30, "#ffffff");
  addCurve(pts, -80, 80, 10, 8, 15, "#ff8ed6");

  // --- Nến (ngắn 1/2) ---
  for (let y = -60; y <= -10; y += 2)
    pts.push({x: 0, y, color: "#ff4d4d"});

// --- Ngọn lửa (vàng, hình thoi nhọn) ---
for (let y = -70; y > -110; y -= 1) {
  // công thức hình thoi: chiều ngang nhỏ dần khi lên cao và xuống thấp
  const halfWidth = Math.max(0, 8 - Math.abs(y + 90) / 2);
  for (let x = -halfWidth; x <= halfWidth; x += 1) {
    pts.push({x, y, color: "#ffd966"}); // vàng sáng
  }
}
  return pts;
}

const cakeOutline = createCakeOutline();

function drawCake() {
  const cx = cakeCanvas.width / 2;
  const cy = cakeCanvas.height / 2 + 10;
  let scale = 0.1;
  const targetScale = 2.5;

  function animate() {
    ctx.fillStyle = "rgba(0,0,0,0.15)";
    ctx.fillRect(0, 0, cakeCanvas.width, cakeCanvas.height);

    if (scale < targetScale) scale += 0.02;

    for (let i = 0; i < 15; i++) {
      const p = cakeOutline[Math.floor(Math.random() * cakeOutline.length)];
      particles.push({
        x: cx + p.x * scale + random(-1, 1),
        y: cy + p.y * scale + random(-1, 1),
        size: random(2, 4),
        alpha: random(0.6, 1),
        flicker: random(0.8, 1.2),
        color: p.color
      });
    }

    for (let p of particles) {
      const flickerAlpha = p.alpha * (0.7 + 0.3 * Math.sin(Date.now() * 0.005 * p.flicker));
      ctx.beginPath();
      ctx.fillStyle = p.color;
      ctx.globalAlpha = flickerAlpha;
      ctx.arc(p.x, p.y, p.size, 0, Math.PI * 2);
      ctx.fill();
      ctx.globalAlpha = 1;
      p.alpha -= 0.006;
    }

    particles = particles.filter(p => p.alpha > 0);
    requestAnimationFrame(animate);
  }
  animate();
}

showNextLine();
</script>
</body>
</html>
